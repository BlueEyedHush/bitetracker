import {saveUpdates, respondWithResult, handleEntityNotFound, handleError} from '../common';
import BaseController from '../base';
import Recipe from './recipe.model';

function removeEntity(res) {
  return function(entity) {
    if (entity) {
      return entity.removeAsync()
        .then(() => {
          res.status(204).end();
        });
    }
    return null;
  };
}

export default class RecipeController extends BaseController(Recipe) {
  update(req, res) {
    if (req.body._id) {
      delete req.body._id;
    }
    Recipe.findByIdAsync(req.params.id)
      .then(handleEntityNotFound(res))
      .then(saveUpdates(req.body))
      .then(respondWithResult(res))
      .catch(handleError(res));
  }

  destroy(req, res) {
    Recipe.findByIdAsync(req.params.id)
      .then(handleEntityNotFound(res))
      .then(removeEntity(res))
      .catch(handleError(res));
  }
}
