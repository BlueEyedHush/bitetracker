'use strict';

import {MongoClient} from 'mongodb';
import config from 'server/config/environment';
import logger from 'winston';

export function connect() {
  return MongoClient.connect(config.mongo.uri)
    .then(database => {
      logger.info('[MongoDB] direct connection successful');
      return database
    })
    .catch(e => {
      logger.error(`[MongoDB] error while establishing direct connection: ${e.stack}`);
      throw e;
    });
}

export function disconnect(db) {
  if(db) {
    return db.close()
      .catch(e => logger.error(`[MongoDB] connection closing failed: ${e.stack}`));
  } else {
    return Promise.resolve(true);
  }
}
