import moment from 'moment';
import alt from 'alt-instance';

import PlannerActions from 'actions/PlannerActions';
import PlannerSource from 'sources/PlannerSource';

class PlannerStore {
  constructor() {
    this.date = moment('2016-12-14');
    this.planner = [];

    this.bindListeners({
      handleFetchPlanner: PlannerActions.FETCH_PLANNER,
      handleChangeDate: PlannerActions.CHANGE_DATE,
    });
  }

  handleFetchPlanner() {
    PlannerSource.fetch(this.date.format())
      .then(planner => {
        this.setState({planner});
    console.log(planner);
      });
  }

  handleChangeDate(date) {
    this.setState({date});
    PlannerActions.fetchPlanner.defer();
  }
}

export default alt.createStore(PlannerStore, 'PlannerStore');
