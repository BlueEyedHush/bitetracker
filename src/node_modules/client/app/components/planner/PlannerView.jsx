import React from 'react';
import moment from 'moment';
import {Table} from 'react-bootstrap';
import Planner from 'schemas/PlannerSchema';
import {mealTypes} from 'schemas/PlannerEntrySchema';

import './planner.scss';

import MealHeader from './MealHeader';
import MealEntries from './MealEntries';

const weekdays = () => new Array(7).fill(0).map((_, i) => moment(i, 'e'));

const PlannerView = ({planner}) => {
  const days = weekdays();
  const mealNodes = [];
  mealTypes.forEach(meal => {
    mealNodes.push((
      <MealHeader meal={meal} days={days} />
    ));
    mealNodes.push((
      <MealEntries planner={planner} meal={meal} days={days} />
    ));
  });

  return (
    <section className="c__planner">
      <Table>
        <thead>
          <tr>
            {days.map(weekday => (
              <th key={weekday.unix()}>{weekday.format('ddd D/M')}</th>
            ))}
          </tr>
        </thead>
        <tbody>
          {mealNodes}
        </tbody>
      </Table>
    </section>
  );
};

PlannerView.propTypes = {
  planner: Planner.isRequired,
};

export default PlannerView;
