import React from 'react'

import storeStateSubscriberCreator from 'client/app/mixins/StoreStateSubscriber';

import MealsStore from 'client/app/stores/MealsStore';
import MealsActions from 'client/app/actions/MealsActions';

import ListGroup from 'react-bootstrap/lib/ListGroup';
import ListGroupItem from 'react-bootstrap/lib/ListGroupItem';
import AddInput from 'client/app/components/shared/form/AddInputC';

const FoodLogP = ({meals, onMealAdded}) => {
  return (
    <div>
      <h2>Food Log</h2>
      <ListGroup>
        {meals.map(m => (<ListGroupItem key={m._id}>{m.name}</ListGroupItem>))}
      </ListGroup>
      <AddInput
        placeholder="Add meal"
        onAdd={value => onMealAdded(value)}
      />
    </div>
  );
};

const MealsStoreStateSubscriber = storeStateSubscriberCreator(MealsStore);
export default class FoodLogC extends MealsStoreStateSubscriber(React.Component) {
  componentDidMount() {
    super.componentDidMount();
    MealsActions.fetchMeals();
  }

  render() {
    return (
      <FoodLogP
        meals={this.state.meals}
        onMealAdded={(name) => MealsActions.addMeal(name)}
      />
    );
  }
}