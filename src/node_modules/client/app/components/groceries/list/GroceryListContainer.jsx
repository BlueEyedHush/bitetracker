import assign from 'lodash/assign';
import React from 'react';
import GroceryListActions from 'actions/GroceryListActions';
import ListSchema from 'schemas/GroceryListSchema';

import GroceryList from './GroceryList';

class ListContainer extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {item: {name: '', completed: false}};

    this.handleItemChange = this.handleItemChange.bind(this);
  }

  handleItemChange(name) {
    this.setState({item: assign({}, this.state.item, {name})});
  }

  render() {
    const {list} = this.props;
    return (
      <GroceryList list={list}
                   onItemChange={this.handleItemChange}
                   onItemSubmit={() => GroceryListActions.addItem(this.props.list._id, this.state.item)}
                   onItemToggle={(itemId) => GroceryListActions.toggleItem(this.props.list._id, itemId)}
                   onItemDelete={(itemId) => GroceryListActions.removeItem(this.props.list._id, itemId)} />
    );
  }
}

ListContainer.propTypes = {
  list: ListSchema.only('_id').isRequired
};

export default ListContainer;
