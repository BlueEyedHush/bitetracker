import React from 'react';
import ReactDOM from 'react-dom';
import { createHistory } from 'history'
import { Router, Route, IndexRoute, useRouterHistory } from 'react-router'

import * as auth from 'client/sharedjs/auth';
import { ensureCookiesEnabled } from 'client/sharedjs/cookies';

import './app.scss';

import App from './components/App'
import Home from './components/home/Home'
import Recipes from './components/recipes/Recipes'
import Log from './components/log/Log'
import Planner from './components/planner/Planner'
import Groceries from './components/groceries/Groceries'
import Notifications from './components/notifications/Notifications'
import Settings from './components/settings/Settings'
import Profile from './components/profile/Profile'
import NotFound from './404'

const history = useRouterHistory(createHistory)({ basename: '/app.html' });

function app() {
  if (!auth.isCookiePresent()) {
    window.location.href = '/';
  } else {
    ReactDOM.render(
        (<Router history={history}>
          <Route path="/" component={App}>
            <IndexRoute component={Home} />
            <Route path="recipes" component={Recipes} />
            <Route path="log" component={Log} />
            <Route path="planner" component={Planner} />
            <Route path="groceries" component={Groceries} />
            <Route path="notifications" component={Notifications} />
            <Route path="settings" component={Settings} />
            <Route path="profile" component={Profile} />
            <Route path="*" component={NotFound} />
          </Route>
        </Router>),
        document.getElementById('content'));
  }
}

ensureCookiesEnabled(app);
