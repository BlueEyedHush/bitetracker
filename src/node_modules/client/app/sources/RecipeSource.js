import axios from 'axios';
import {arrayOf} from 'normalizr';
import RecipesActions from 'actions/RecipesActions';
import RecipeActions from 'actions/RecipeActions';
import createAsync from './create-async';
import recipe from './schemas/recipes';

const RECIPES_PATH = '/api/recipes';

const RecipeSource = {
  fetch: {
    request: () => axios.get(RECIPES_PATH),
    success: RecipesActions.fetchSuccess,
    error: RecipesActions.fetchFailure,
    normalized: arrayOf(recipe),
  },
  create: {
    request: data => {console.log(data); return axios.post(RECIPES_PATH, data)},
    success: RecipeActions.submitSuccess,
    error: RecipeActions.submitFailure,
    normalized: recipe,
  }
};

export default createAsync(RecipeSource);
