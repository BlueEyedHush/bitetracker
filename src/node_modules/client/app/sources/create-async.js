import {normalize} from 'normalizr';

const async = ({request, success, error, normalized}) => (...args) => {
  return request(...args)
    .then(response => {
      if (typeof success === 'function') {
        success(normalize(response.data || response, normalized));
      }
    })
    .catch(error);
};

export default function createAsync(actions) {
  const source = {};
  Object.keys(actions)
    .forEach(key => {
      source[key] = async(actions[key]);
    });
  return source;
}
