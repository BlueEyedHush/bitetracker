
import axios from 'axios';
import MealsActions from 'client/app/actions/MealsActions';

const MEALS_PATH = '/api/foods';

const MealsSource = {
  fetch: (ndbno) => {
    return axios.get(`${MEALS_PATH}/${ndbno}`)
      .then(response => {
        const nutrientList = response.data.report.food.nutrients;

        const nutrientsMap = {};
        nutrientList.forEach(nutrient => {
          nutrientsMap[nutrient.nutrient_id] = nutrient;
        });

        MealsActions.fetchNutrientsSuccess(nutrientsMap);
      })
      .catch(error => {
        // access response via error.response
        MealsActions.fetchNutrientsFailure(error);
      });
  }
};

export default MealsSource;
