
const mealList = [
  {_id: '1', name: 'meal 1', date: getOffsetDateFromNow(-1)},
  {_id: '2', name: 'meal 2', date: getOffsetDateFromNow(0)},
  {_id: '3', name: 'meal 3', date: getOffsetDateFromNow(1)},
];
var nextId = 4;

function getMealList(date) {
  return mealList.filter(meal => areDatesEqual(date, meal.date));
}

const MealsSource = {
  fetch: (date) => Promise.resolve(getMealList(date)),
  add: (date, name) => {
    mealList.push({_id: nextId.toString(), name, date});
    nextId += 1;
    return Promise.resolve(getMealList(date));
  }
};

function getOffsetDateFromNow(offsetDays) {
  const now = new Date();
  return new Date(now.setDate(now.getDate() + offsetDays));
}

function areDatesEqual(date1, date2) {
  const extractDate = (date) => date.toISOString().substring(0,10);
  return extractDate(date1) === extractDate(date2);
}

export default MealsSource;
